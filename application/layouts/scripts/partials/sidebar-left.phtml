<?php
/**
 * Left sidebar view script
 * 
 * @author  Antony Repin
 * @package rutvgid
 * @version $Id: sidebar-left.phtml,v 1.13 2013-04-03 18:18:05 developer Exp $
 *
 */
?>

<?php 
if (isset($this->announces) && ($this->announces!==false)  && ($this->show_announces===true)) { ?>
<div class="module">
	<ul class="nav nav-pills nav-list">
    <?php foreach ($this->announces as $article){ 
        $linkAttrHref = $this->url( array(
        	'content_cat'=>$article->content_cat_alias,
        	'article_alias'=>$this->escape($article->alias)), 'default_content_article' );
        ?>
    	<li><a href="<?php echo $linkAttrHref; ?>" title="<?php printf( "%s новости", $article->content_cat_title ); ?>"><?php echo $article->title; ?></a></li>  
    <?php } ?>
    </ul>
</div>    
    <?php 
}

?>

<?php
/*
 * Channels categories block
 */ 
if (isset($this->cats) && !empty($this->cats)) {
    ?>
<div class="module">
	<?php /*<h4>Каналы</h4>*/ ?>
	<ul id="channels_categories" class="nav nav-list">
	<?php 
	foreach ($this->cats as $c) {
		$catAlias = $this->escape( $c['alias'] );
		$catTitle = $this->escape( Xmltv_String::ucfirst( Xmltv_String::strtolower( $c['title'] )));
		$imgAttrAlt =  $this->escape( $c['title'] ).' лого';
		$imgAttrSrc =  $this->baseUrl( 'images/categories/channels/'.$this->escape( $c['image'] ));
		$linkAttrHref = $this->url(array('category'=>$catAlias), 'default_channels_category' );
		?>
		<li><a href="<?php echo $linkAttrHref ?>" target="_blank">
			<img src="<?php echo $imgAttrSrc ?>" class="icon" alt="<?php echo $imgAttrAlt ?>" />
			<?php echo $catTitle ?>
		</a></li>		
		<?php 
	}
	?>
	</ul>
</div>	
	<?php 
}
?>

<?php 
/*
 * Top programs block
 */
if (isset($this->top_programs) && !empty($this->top_programs)) {
	?>
<div class="module">
	<h4>Популярные программы на этой неделе</h4>
	<ul id="program-top">
		<?php 
		foreach ($this->top_programs as $prog){
		    
		    if (APPLICATION_ENV=='development'){
			    //var_dump($prog);
			    //die(__FILE__.': '.__LINE__);
		    }
		    
		    ?>
		<li>
			<img src="<?php echo $this->baseUrl( 'images/channel_logo/'.$prog['channel_icon'] ) ?>" width="16" />
			<a href="<?php echo $this->url( array('channel'=>$prog['channel_alias'], 'alias'=>$prog['alias']), 'default_listings_program-week'); ?>"
				title="<?php echo $this->escape( sprintf("«%s» на канале «%s» на этой неделе", $prog['title'], $prog['channel_title'])) ?>"
				target="_blank"><?php echo $this->truncateString( $prog['title'], 3, 'words') ?>
			</a>
		</li>
			<?php 
			
		}
		?>
	</ul>
</div>	
	<?php 
}
?>


