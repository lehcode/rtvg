<?php 
/**
 * Right sidebar view script
 * 
 * @author  Antony Repin
 * @package rutvgid
 * @version $Id: sidebar-right.phtml,v 1.2 2012-12-27 17:04:37 developer Exp $
 *
 */
?>

<gcse:searchbox></gcse:searchbox>

<script type="text/javascript" src="http://www.adcash.com/script/java.php?option=rotateur&rotateur=106375"></script>

<?php
//var_dump($this->videos);
if (count($this->videos)>0 && $this->videos!==true) {
    //var_dump($this->videos);
    //die(__FILE__.': '.__LINE__);
	$channelTitle = $this->escape($this->channel->title);
	$this->headScript()->appendScript("$(function() { 
	var icons = { header: 'ui-icon-circle-arrow-e', activeHeader: 'ui-icon-circle-arrow-s' };
	$( '#col_r .videos_sidebar' ).accordion({
		header: 'h4',
		clearStyle: true,
		collapsible: true,
		active: 0,
		icons:{
			'header': 'ui-icon-plus',
			'headerSelected': 'ui-icon-minus',
		}
	}); });");
	?>
	
	<div class="module">
	
		<h3 class="mediumheading">Онлайн-видео <?php echo $channelTitle ?></h3>
		
		<div class="videos_sidebar">
		<?php 
		
		foreach ($this->videos as $video) {
			?>
			
			<?php $videoTitle = $this->escape( $this->truncateString( $video->title, 38, 'letters' ) ); ?>
			<h4><i class="icon-plus icon-white"></i><?php echo $videoTitle ?></h4>
			
			<div class="info">
				
				<p class="viewcount">
					Понравилось <?php echo $video->views; ?> посетителям
				</p>
				
				<?php 
				$thumb = $video->thumbs[rand(0, count($video->thumbs)-1)];
				$link_title = empty($video->desc) ? $videoTitle. $this->escape( $this->truncateString( $video->desc, 40, 'letters') ) : $videoTitle ; 
				$link_href = $this->url(array('alias'=>$video->alias, 'id'=>$video->rtvg_id), 'default_videos_show-video');
				?>
				
				<a href="<?php echo $link_href ?>" title="Клик чтобы смотреть видео <?php echo $link_title ?>" target="_blank">
					<img src="<?php echo $thumb->url ?>" alt="<?php echo $link_title ?>" />
				</a>
				
				<a class="btn btn-inverse btn-mini" href="<?php echo $link_href ?>" title="<?php echo $link_title ?> видео">
					Смотреть
				</a>
				
				<div class="date">
					Загружено: <?php echo $video->published->toString('dd MMMM YYYY'); ?>
				</div>
				
				<div class="duration">
					Длительность: <?php echo $video->duration->toString("mm:ss"); ?>
				</div>
				
				<?php  if (!empty($video->desc)) : ?>
				<p class="desc">
					<?php 
					$desc = $this->truncateString( $video->desc, 30, 'words') ; 
					if (stristr($desc, $this->channel->title)) {
						$href = '<a href="'.$this->url(array('channel'=>$this->channel->ch_alias), 'default_listings_day-listing').'" target="_blank" title="Программа канала '.$this->channel->title.'">'.$this->channel->title.'</a>';
						$desc = str_ireplace($this->channel->title, $href, $desc);
					}
					echo $desc;
					?>
				</p>
				<?php endif; ?>
				
			</div> 
		<?php 
		
		}
		?>
			
	</div>
</div>
		<?php 		
	
	?>
	
<?php 
}
?>
	
<?php 
if (@!in_array($this->channel->category, $this->kids_channels)) {
	$this->inlineScript()->appendScript("$(document).ready(function(){ $('#rumor-ads').css({ display: 'block' }); });");
?>
<div class="module" id="rumor-ads">
	<h4 class="mediumheading">Желтая пресса</h4>
	<div class="content" id="DIV_DA_85753"></div>
</div>
<?php 
} ?>



