<?php
/**
 * Administrator control panel layout
 * 
 * @author     Antony Repin
 * @subpackage backend
 * @version    $Id: admin.phtml,v 1.12 2013-03-17 18:34:58 developer Exp $
 *
 */
$this->headMeta()->appendHttpEquiv('Content-Type', 'text/html;charset=utf-8'); 
$this->headScript()->setAllowArbitraryAttributes(true);
$this->jQuery()
	->enable()
	->setVersion('1.8.3')
	->setUiVersion('1.8.18')
	->addStylesheet('https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/ui-lightness/jquery-ui.css')
	->uiEnable();

$this->headLink( array('rel'=>'stylesheet/less', 'href'=>$this->baseUrl('css/template.less')), 'APPEND')
	->appendStylesheet( $this->baseUrl('css/admin-template.css'), 'screen');

$request    = Zend_Controller_Front::getInstance()->getRequest();
$controller = $request->getControllerName();

if (APPLICATION_ENV=='development'){
	//var_dump($this->user);
	//die(__FILE__.': '.__LINE__);
}


?>
<?php echo $this->doctype(); ?>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">
<head>
<?php 
echo $this->headMeta();
echo $this->headTitle();
echo $this->jQuery();
echo $this->headLink();
echo $this->headStyle();
echo $this->headScript();
?>
</head>
<body>

	<div class="admin container-fluid" id="topline">
		<span class="label">Администрирование</span>
		<?php if ($this->user->role!='guest'){
			echo '<span class="label label label-important">'.
			$this->escape( $this->user->display_name.': ['.
			$this->user->role.']').'</span>&nbsp;<b>'.
			$this->escape('<'.$this->user->email.'>' ).'</b>&nbsp;'.
			'<span><a href="/" target="_blank">http://rutvgid.ru</a></span>'; 
		} ?>
	</div>

	<div class="admin container-fluid">

	<?php echo (count($this->messages)>0 ? $this->showMessages( $this->messages ) : null ); ?>
	
	<?php if ($this->isAllowed('admin:auth') && $this->user['role']!='guest') {
		// Header HTML
		?>
		<div id="header" class="row-fluid">
			<div class="navbar span11">
				<div class="navbar-inner">
					<?php $this->navigation()->menu( Zend_Registry::get('AdminMenu') )
						->setPartial( array('partials/nav.phtml', 'admin'));
					echo $this->navigation()
						->setMaxDepth(2)
						->setInjectTranslator(false)
						->menu();
					?>
				</div>
			</div>
			<?php 
			// Logout form
			$form = new Xmltv_Form_Logout(array(
				'action'=>$this->baseUrl('admin/auth/logout'),
				'submit_text'=>'Выход',
				'form_class'=>'',
				'html_tag_class'=>'span1',
			));
			echo $form;
			?>
		</div>
		<?php 
		if ($this->isAllowed('admin:sysinfo')){
			// Some system info
			echo $this->sysinfo();
		}
	} ?>

	
	<?php $bc = $this->navigation()->breadcrumbs( Zend_Registry::get('AdminMenu') )->setLinkLast(false)->setMinDepth(0)->render();
	if (!empty($bc)){
		?><div class="breadcrumb row-fluid"><?php printf("Вы здесь: %s", $bc); ?></div>
	<?php } ?>
	

	<div class="row-fluid" id="area">
		<?php echo $this->layout()->content; ?>
	</div>
	
	<div class=row-fluid>
		<?php echo '&copy;egeshi.com '.Zend_Registry::get('rtvg_version'); ?>
	</div>
	
	</div>


<?php echo $this->inlineScript(); ?>

</body>
</html>