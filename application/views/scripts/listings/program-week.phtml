<?php
/**
 * Программа на неделе
 * 
 * @author  Antony Repin
 * @package rutvgid
 * @version $Id: program-week.phtml,v 1.6 2012-08-03 00:16:56 developer Exp $
 *
 */

$programTitle = @isset($this->list[0]) ? $this->escape( $this->list[0]['title'] ) : '';
$weekStart    = $this->escape( $this->dates['start']->toString('EEEE, d MMMM'));
$weekEnd      = $this->escape( $this->dates['end']->toString('EEEE, d MMMM'));
$channelTitle = @isset($this->channel->title) ? $this->escape( $this->channel->title ) : '' ;
$channelAlias = @isset($this->channel->alias) ? $this->escape( Xmltv_String::strtolower( $this->channel->alias )): '' ;

?>

<div id="fast_search">
	<?php $form = new Xmltv_Form_FastChannelSearchForm(); echo $form; ?>
</div>
<h4><?php echo $weekStart; ?> - <?php echo $weekEnd; ?></h4>
<h1><?php printf('<i>«%s»</i><br />на канале <i>«%s»</i>', $programTitle, $channelTitle) ?></h1>

<?php 
$startDates = array();
foreach ($this->list as $single) {
	$singleAlias = $this->escape($single['alias']);
	$start = new Zend_Date( $single['start']);
	$startDates[]= '<li><a href="/телепрограмма/'.$channelAlias.'/'.$singleAlias.'/'.$this->escape( $start->toString('yyyy-MM-dd') ).'#'.$start->toString('U').'">'.$this->escape( Xmltv_String::ucfirst( $start->toString( 'd MMMM (EEEE) в HH:mm'))).'</a></li>';
}
?>

<?php  if (!empty($startDates)) : ?>
<p><?php printf('На этой неделе вы можете посмотреть программу <b>«%s»</b> на канале <a href="%s">«%s»</a> в следующие дни:<br/>%s', $programTitle, '/телепрограмма/'.$channelAlias, $channelTitle, '<ul class="nav nav-tabs nav-stacked">'.implode(PHP_EOL, $startDates)).'</ul>' ?></p>
<?php else : ?>
<p><?php printf("На этой неделе программу <b>«%s»</b> показывать позже не будут.", $programTitle) ?></p>
<?php endif; ?>

<?php /*
<table class="table table-condensed">
	<tbody>
		<?php
		foreach ($this->list as $single) {
		$start = new Zend_Date($single['start']);
		?>
		<tr>
			<td><?php echo Xmltv_String::ucfirst( $start->toString( 'EEEE, d MMMM', null, 'ru' ) ); ?></td>
			<td><?php echo $single['title'] ?></td>
		</tr>
		
		<?php 
}
?>
	</tbody>
</table>
*/ ?>